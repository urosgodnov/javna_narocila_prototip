# Story: 12.1 - Implement Template Admin Service

## Status: Draft

## Story
As an administrator, I want to manage Word templates, including viewing, uploading, and overwriting them, so that the system can use up-to-date templates for document generation.

## Acceptance Criteria
1.  A dedicated "Template Admin" section is accessible in the Streamlit application (e.g., via a sidebar link or a separate page).
2.  The Template Admin section allows viewing a list of available Word templates.
3.  The Template Admin section provides functionality to upload new `.docx` templates.
4.  The Template Admin section allows overwriting existing `.docx` templates.
5.  The Template Admin section provides functionality to clear or back up SQLite drafts (as per architecture).
6.  The Template Admin section provides functionality to manage ChromaDB collections (as per architecture).
7.  The application functions correctly after template management operations.

## Dev Notes
*   This story involves creating a new Python module (e.g., `template_service.py`) to handle template file operations and potentially database interactions related to templates.
*   `app.py` will need modifications to include the Template Admin UI and integrate with the `template_service.py`.
*   Template files will likely be stored in a designated directory (e.g., `templates/`).
*   `python-docx` will be used for parsing `.docx` templates.
*   Security for the admin UI (e.g., secret URL or token) is mentioned in the architecture but might be out of scope for this initial implementation of the service itself.

## Tasks / Subtasks
- [ ] **Task 1 (AC: 1, 2, 3, 4, 5, 6, 7):** Implement `template_service.py` for template management.
    - [ ] Subtask 1.1: Create a directory for storing templates (e.g., `templates/`).
    - [ ] Subtask 1.2: Implement a function to list available `.docx` templates.
    - [ ] Subtask 1.3: Implement a function to save/upload a new `.docx` template.
    - [ ] Subtask 1.4: Implement a function to overwrite an existing `.docx` template.
    - [ ] Subtask 1.5: Implement functions to clear and back up SQLite drafts (integrating with `database.py`).
    - [ ] Subtask 1.6: Implement functions to manage ChromaDB collections (placeholder for now, actual implementation in future stories).
- [ ] **Task 2 (AC: 1, 2, 3, 4, 5, 6, 7):** Integrate Template Admin UI into `app.py`.
    - [ ] Subtask 2.1: Add a navigation element (e.g., `st.sidebar.radio` or `st.tabs`) to switch between the main form and the Template Admin section.
    - [ ] Subtask 2.2: Design and implement the UI for listing templates.
    - [ ] Subtask 2.3: Design and implement the UI for uploading/overwriting templates (`st.file_uploader`).
    - [ ] Subtask 2.4: Design and implement UI for clearing/backing up drafts.
    - [ ] Subtask 2.5: Design and implement UI for managing ChromaDB collections.
- [ ] **Task 3:** Update unit tests (`tests/test_form_service.py` and new `tests/test_template_service.py`) to cover template management logic.
- [ ] **Task 4:** Update integration tests (`tests/test_app_integration.py`) to verify Template Admin UI and functionality.
- [ ] **Task 5:** Update end-to-end tests (`tests/test_e2e.py`) to verify navigation to and basic interaction with the Template Admin section.
