---
Story: 16.1
Epic: 16
Title: Implement Multi-Step Procurement Form
Status: Ready for Review
---

### Story

As a user, I want to fill out the public procurement form in a multi-step process, so that the form is not overwhelming and I can fill it out section by section.

### Acceptance Criteria

1.  The form must be divided into 5 sequential steps.
2.  Each step must contain the fields as defined in the tasks below.
3.  The UI must be clean, and it should be clear to the user which step they are on.
4.  Navigation buttons (Next, Previous) must be present to move between steps.
5.  Data entered in each step must be preserved when navigating between steps.
6.  The final step will have a "Submit" button.
7.  Input validation must be performed on each step before proceeding to the next.

### Tasks / Subtasks

- [x] **Task 1: Implement Step 1 - Basic Information**
    - [x] Create a form section for "Podatki o naročniku" (Client Data) with fields for "Naziv" (Name) and "Naslov" (Address).
    - [x] Create a field for "Naziv javnega naročila" (Project Name).
    - [x] Add "Next" button.

- [x] **Task 2: Implement Step 2 - Procedure and Type**
    - [x] Create a form section for "Postopek oddaje javnega naročila" (Submission Procedure) as a dropdown/radio button list.
    - [x] Create a form section for "Vrsta javnega naročila" (Order Type).
        - [x] Include a dropdown for "Vrsta" (Type).
        - [x] Conditionally display fields for "Vrednost blaga", "Vrednost storitev", "Vrednost gradenj" based on the selection in "Vrsta".
    - [x] Add "Previous" and "Next" buttons.

- [x] **Task 3: Implement Step 3 - Conditions and Reasons**
    - [x] Create a form section for "Razlogi za izključitev" (Exclusion Reasons) as a multi-select checklist.
    - [x] Create a form section for "Pogoji za sodelovanje" (Participation Conditions).
        - [x] Include a multi-select checklist for "Izbrani pogoji" (Selected Conditions).
        - [x] Include a sub-section for "Tehnične zahteve" (Technical Requirements) with all its text fields.
    - [x] Add "Previous" and "Next" buttons.

- [x] **Task 4: Implement Step 4 - Financials and Criteria**
    - [x] Create a form section for "Finančna zavarovanja" (Financial Guarantees) as a multi-select checklist.
    - [x] Create a form section for "Merila" (Selection Criteria) as a multi-select checklist.
    - [x] Add text area fields for "Socialna merila (opis)" and "Druga merila (opis)".
    - [x] Add "Previous" and "Next" buttons.

- [x] **Task 5: Implement Step 5 - Contract Details**
    - [x] Create a form section for "Pogodba / Okvirni sporazum" (Contract / Framework Agreement).
        - [x] Include a dropdown for "Vrsta" (Type).
        - [x] Include date pickers for "Veljavnost od" (Valid From) and "Veljavnost do" (Valid To).
        - [x] Include a text field for "Odpiranje konkurence vsake" (Competition Frequency).
    - [x] Add "Previous" and "Submit" buttons.

### Dev Notes

- The form logic should be driven by the `SEZNAM_POTREBNIH_PODATKOV.json` schema.
- The UI should be implemented in `ui/form_renderer.py`.
- The multi-step logic will require state management to hold form data between steps.

### Testing

- All form fields must be tested for correct data input and validation.
- Navigation between steps must be tested to ensure no data is lost.
- The final submission payload must be validated against the complete JSON schema.

### Dev Agent Record

- **Agent Model Used**: Gemini
- **Debug Log References**: N/A
- **Completion Notes**: 
    - Updated `config.py` to define the 5 steps for the form.
    - Refactored `ui/form_renderer.py` to remove hardcoded conditional logic and correctly render array-based multiselect fields from the JSON schema.
    - The main application in `app.py` now drives the multi-step form flow.
- **File List**:
    - `config.py`
    - `ui/form_renderer.py`
    - `docs/stories/16.1.story.md`
- **Change Log**:
    - Modified `config.py` to update `FORM_STEPS`.
    - Modified `ui/form_renderer.py` to fix a bug in array rendering.
